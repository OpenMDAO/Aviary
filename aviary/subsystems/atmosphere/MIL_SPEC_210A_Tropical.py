SOURCE_NOTE = '''
This information applies to MIL_SPEC_201A_tropical, MIL_SPEC_201A_polar, MIL_SPEC_201A_cold, 
and MIL_SPEC_201A_hot

Source:
Data for the models was obtained from ASC-TR-93-5002 / AD-A264 639, 
Graphical Comparison of U.S. Standard Atmospheres and Military Standard Climatic Extremes
by Joseph C. Zuppardo, February 1993
Approved for public release with unlimited distribution
https://apps.dtic.mil/sti/tr/pdf/ADA264639.pdf

Notes:
0) The value of gravity is constant, i.e., 32.174 ft/sec2
1) The composition of the atmosphere is constant throughout the altitude range.
2) Polar data represents an Arctic Winter atmosphere rather than a true polar atmosphere
3) Altitude was given in the raw data as Geopotential Altitude
4) Raw data was not available for altitudes below 0ft and was extrapolated based on linear 
interpolation for the purposes of padding the table only.
5) Some data points in the original tables appeared to be in error. 
i.e. for hot atmospher at 20,000 ft pressure increased so much as to be the same as pressure
at 11,500 ft. Presumed errors like these were smoothed out to prevent kinks in the akima 
splines.
6) This data set appears to have measured values for: Temperature, Pressure, and Density
as a function of altitude. Using the ideal gas equations to recalculate Density will yield
different results than the table. 
'''

# 6) Temperature in F was converted to Temp in R using the formula:
# F + 459.67 = R
# 7) Pressure in Hg was converted to pressure in psi using the formula:
# in_Hg / 2.03602 = psi
# 8) Denisty in lb/ft^3 was converted to slugs/ft^3 using the formula:
# lb/ft^3 / 32.174 = slugs/ft^3
# 9) Speed of Sound was calculated based on the formula:
# (https://www.grc.nasa.gov/www/k-12/VirtualAero/BottleRocket/airplane/sound.html)
# R0 (ft*lbf / (slug * R)) = 1716.46 # ideal gas constant
# Gamma (unitless) = 1.4 # the ratio of specific heats for air at Standard Temp and Pressure
# sqrt(R * R0 * Gamma) = speed_of_sound
# 10) Dynamic Viscosity was calculated based on Southerland's formula 
# (https://www.grc.nasa.gov/www/k-12/airplane/viscosity.html)
# with temperatures converted to Kelvin:
# mu0 (lbf * s / ft^2) = 3.62E-7 # reference dunamic viscosity coefficient
# T0 (R) = 518.7 # reference temperature
# mu0 * (R / T0)^1.5 * (T0 + 197.72)/(R + 198.72) = dynamic_viscosity

from collections import namedtuple
import numpy as np
atm_data = namedtuple('MIL_SPEC_210A_Tropical', ['alt', 'temp', 'pres', 'rho'])
atm_data.__doc__ = \
    """
    A namedtuple to hold data for the atmosphere model.

    Parameters
    ----------
    alt : float
        Geopotential Altitude (feet)
    temp : float
        Temperature (degF)
    pres : float
        Pressure (inches of mercury) aka (inHG).
    rho : float
        Density in (lb/ft**3)
    """

_raw_data = np.array([
    -5000,109.8,35.32,0.082880293, #Extrapolated
    -4500,107.8,34.78,0.081818555, #Extrapolated
    -4000,105.8,34.24,0.080756817, #Extrapolated
    -3500,103.8,33.7,0.079695079, #Extrapolated
    -3000,101.8,33.16,0.078633341, #Extrapolated
    -2500,99.8,32.62,0.077571603, #Extrapolated
    -2000,97.8,32.08,0.076509865, #Extrapolated
    -1500,95.8,31.54,0.075448127, #Extrapolated
    -1000,93.8,31,0.074386389, #Extrapolated
    -500,91.8,30.46,0.073324651, #Extrapolated
    0,89.8,29.92,0.072262913,
    500,87.8,29.38,0.071201175,
    1000,85.9,28.85,0.070171602,
    1500,84,28.33,0.069142029,
    2000,82,27.82,0.068144634,
    2500,80.1,27.31,0.06714724,
    3000,78.1,26.82,0.066149846,
    3500,76.2,26.32,0.065184623,
    4000,74.3,25.84,0.0642194,
    4500,72.3,25.36,0.063254185,
    5000,70.4,24.89,0.062321134,
    5500,68.4,24.43,0.061388087,
    6000,66.5,23.98,0.060455039,
    6500,64.6,23.53,0.059554167,
    7000,62.6,23.09,0.058653291,
    7500,60.7,22.65,0.057752419,
    8000,58.7,22.22,0.056883715,
    8500,56.8,21.8,0.056015018,
    9000,54.9,21.39,0.055146318,
    9500,52.9,20.98,0.054309793,
    10000,51,20.58,0.053473268,
    10500,49.1,20.18,0.052636743,
    11000,47.1,19.79,0.051800217,
    11500,45.2,19.41,0.050995871,
    12000,43.2,19.03,0.050191518,
    12500,41.3,18.66,0.04941934,
    13000,39.4,18.29,0.048647162,
    13500,37.4,17.93,0.047874983,
    14000,35.5,17.58,0.047102809,
    14500,33.6,17.23,0.046330627,
    15000,31.6,16.89,0.045590628,
    15500,29.7,16.55,0.044882804,
    16000,27.8,16.22,0.044142794,
    16500,25.8,15.89,0.043434966,
    17000,23.9,15.57,0.042727135,
    17500,21.9,15.25,0.042019311,
    18000,20,14.94,0.041343655,
    18500,18.1,14.64,0.040635828,
    19000,16.1,14.34,0.039960168,
    19500,14.2,14.04,0.039316688,
    20000,12.3,13.75,0.038641032,
    20500,10.3,13.46,0.037997555,
    21000,8.4,13.18,0.037354071,
    21500,6.5,12.91,0.036742765,
    22000,4.5,12.64,0.036131456,
    22500,2.6,12.37,0.035487977,
    23000,0.7,12.11,0.034908842,
    23500,-1.3,11.85,0.034297537,
    24000,-3.2,11.6,0.033718403,
    24500,-5.1,11.35,0.033139274,
    25000,-7,11.1,0.03256014,
    25500,-9,10.66,0.031981006,
    26000,-10.9,10.63,0.031421173,
    26500,-12.8,10.4,0.030867703,
    27000,-14.8,10.17,0.030324042,
    27500,-16.7,9.94,0.029786734,
    28000,-18.6,9.72,0.029255861,
    28500,-20.6,9.51,0.028731424,
    29000,-22.5,9.3,0.028216641,
    29500,-24.4,9.09,0.027708292,
    30000,-26.3,8.89,0.027206376,
    30500,-28.3,8.68,0.026710896,
    31000,-30.2,8.49,0.026225068,
    31500,-32.1,8.29,0.025742456,
    32000,-34.1,8.11,0.025269497,
    32500,-36,7.92,0.024799757,
    33000,-37.9,7.74,0.024339668,
    33500,-39.8,7.56,0.023886014,
    34000,-41,7.38,0.023438795,
    34500,-43.7,7.21,0.022998011,
    35000,-45.6,7.04,0.022560444,
    35500,-47.6,6.87,0.022132531,
    36000,-49.5,6.71,0.021711046,
    36500,-51.4,6.55,0.021296002,
    37000,-53.3,6.4,0.020887394,
    37500,-55.2,6.24,0.020488434,
    38000,-57.1,6.1,0.020095911,
    38500,-59,5.95,0.019709824,
    39000,-60.9,5.81,0.019333387,
    39500,-62.8,5.67,0.018963385,
    40000,-64.6,5.54,0.018599818,
    40500,-66.5,5.41,0.018242685,
    41000,-68.3,5.28,0.017895207,
    41500,-70.1,5.15,0.017550943,
    42000,-72,5.03,0.017216332,
    42500,-73.8,4.91,0.016884942,
    43000,-75.6,4.79,0.016563199,
    43500,-77.4,4.68,0.016244678,
    44000,-79.2,4.57,0.01593259,
    44500,-81,4.46,0.015630152,
    45000,-82.8,4.35,0.015330935,
    45500,-84.5,4.25,0.015034933,
    46000,-86.3,4.15,0.014748584,
    46530,-88,4.05,0.014465452,
    47000,-89.8,3.96,0.014188755,
    47500,-91.5,3.86,0.013918494,
    48000,-93.2,3.77,0.013651448,
    48500,-94.9,3.68,0.01339084,
    49000,-96.7,3.59,0.013133448,
    49500,-98.4,3.51,0.01288249,
    50000,-100.1,3.42,0.012634749,
    50500,-101.7,3.34,0.012393444,
    51000,-103.4,3.26,0.012155357,
    51500,-105.1,3.19,0.011923703,
    52000,-106.8,3.11,0.011695267,
    52500,-108.4,3.04,0.011470049,
    53000,-110.1,2.96,0.011251265,
    53500,-111.7,2.89,0.011035698,
    53595,-112,2.88,0.01099709,
    54000,-111.1,2.83,0.010755785,
    54500,-110.1,2.76,0.010469436,
    55000,-109,2.69,0.010189521,
    55500,-107.9,2.63,0.009916042,
    56000,-106.8,2.57,0.009652215,
    56500,-105.7,2.51,0.009394823,
    57000,-104.6,2.45,0.009140648,
    57500,-103.5,2.39,0.008896125,
    58000,-102.5,2.33,0.008658037,
    58500,-101.4,2.28,0.008426383,
    59000,-100.2,2.22,0.008201165,
    59500,-99.1,2.17,0.007982382,
    60000,-98,2.12,0.007770034,
    60500,-96.9,2.07,0.007560902,
    61000,-95.8,2.02,0.007358206,
    61500,-94.7,1.97,0.007161944,
    62000,-93.6,1.92,0.006972117,
    62500,-92.4,1.88,0.006785507,
    63000,-91.3,1.83,0.006602115,
    63500,-90.2,1.79,0.006428375,
    64000,-89,1.75,0.006254635,
    64500,-87.9,1.71,0.006007331,
    65000,-86.7,1.67,0.00592646,
    65500,-85.6,1.63,0.00576559,
    66000,-84.4,1.59,0.005611154,
    66500,-83.3,1.55,0.005463154,
    67000,-82.1,1.51,0.005315153,
    67500,-81,1.48,0.005173587,
    68000,-79.8,1.44,0.005035239,
    68500,-78.6,1.41,0.004900108,
    69000,-77.5,1.37,0.004771411,
    69500,-76.3,1.34,0.004642716,
    69620,-76,1.33,0.004613759,
    70000,-75.5,1.31,0.004523671,
    70500,-74.8,1.28,0.004407845,
    71000,-74.1,1.25,0.004295236,
    71500,-73.4,1.22,0.004185844,
    72000,-72.803,1.19,0.004079669,
    72500,-72.1,1.16,0.003976713,
    73000,-71.4,1.13,0.003873756,
    73500,-70.7,1.11,0.003774016,
    74000,-70,1.08,0.003680711,
    74500,-69.3,1.05,0.003504189,
    75000,-68.6,1.03,0.003494102,
    75500,-67.9,1.01,0.003404015,
    76000,-67.2,0.981,0.003171445,
    76500,-66.6,0.958,0.003233492,
    77000,-65.9,0.935,0.00315177,
    77500,-65.2,0.913,0.003071657,
    78000,-64.5,0.891,0.002993152,
    78500,-63.8,0.87,0.002916899,
    79000,-63.1,0.85,0.002842577,
    79500,-62.4,0.83,0.002770186,
    80000,-61.7,0.81,0.002699725,
    80500,-61,0.791,0.002630872,
    81000,-60.2,0.772,0.00256395,
    81500,-59.5,0.753,0.002498637,
    82000,-58.8,0.736,0.002434932,
    82500,-58.1,0.718,0.002372336,
    83000,-57.4,0.701,0.002312671,
    83500,-56.7,0.685,0.002254114,
    84000,-56,0.668,0.002197166,
    84500,-55.3,0.653,0.002141505,
    85000,-54.6,0.637,0.002087774,
    85500,-53.9,0.622,0.00203533,
    86000,-53.2,0.608,0.001984174,
    86510,-52.5,0.594,0.001934626,
    87000,-51.8,0.58,0.001886365,
    87500,-51,0.566,0.00183939,
    88000,-50.3,0.553,0.001793182,
    88500,-49.6,0.54,0.001748981,
    89000,-48.9,0.528,0.001705546,
    89500,-48.2,0.516,0.001663398,
    90000,-47.5,0.504,0.001622537,
    90500,-46.8,0.492,0.001582642,
    91000,-46.1,0.481,0.001543711,
    91500,-45.4,0.47,0.001505746,
    92000,-44.7,0.459,0.001468745,
    92500,-44,0.449,0.001433032,
    93000,-43.3,0.439,0.001397962,
    93500,-42.6,0.429,0.001363858,
    94000,-41.9,0.419,0.00133104,
    94500,-41.2,0.41,0.001298866,
    95000,-40.5,0.4,0.001267336,
    95500,-39.8,0.391,0.00123677,
    96000,-39.1,0.383,0.001206849,
    96500,-38.4,0.374,0.001177892,
    97000,-37.7,0.366,0.001149579,
    97500,-37,0.357,0.001121909,
    98000,-36.3,0.349,0.001095205,
    98500,-35.6,0.342,0.001069144,
    99000,-34.9,0.334,0.001043726,
    99500,-34.2,0.327,0.001018952,
    100000,-33.5,0.32009,0.000994822,
    ])

_raw_data = np.reshape(_raw_data, (_raw_data.size // 6, 6))

atm_data.alt = _raw_data[:, 0]

atm_data.T = _raw_data[:, 1]

atm_data.P = _raw_data[:, 2]

atm_data.rho = _raw_data[:, 3]