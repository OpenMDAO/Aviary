"""
United States standard atmosphere 1976 tables, data
obtained from http://www.digitaldutch.com/atmoscalc/index.htm
based on NASA-TM-X-74335.
"""
from collections import namedtuple
import sys

import numpy as np

import openmdao.api as om

atm_data = namedtuple('USatm1976Data', ['alt', 'temp', 'pres', 'rho'])
atm_data.__doc__ = \
    """
    A namedtuple to hold data for the 1976 standard atmosphere model.

    Parameters
    ----------
    alt : float
        Geopotential Altitude in feet.
    temp : float
        Temperature in degR.
    pres : float
        Pressure in psi.
    rho : float
        Density in slug/ft**3.
    """

# TODO: Replace all these values with the actual raw input
_raw_data = np.array([
    -1.50E+04, 5.72162E+02, 2.46176E+01, 3.60978E-03,
    -1.40E+04, 5.68596E+02, 2.38218E+01, 3.51500E-03,
    -1.30E+04, 5.65030E+02, 2.30469E+01, 3.42213E-03,
    -1.20E+04, 5.61464E+02, 2.22926E+01, 3.33115E-03,
    -1.10E+04, 5.57898E+02, 2.15584E+01, 3.24203E-03,
    -1.00E+04, 5.54332E+02, 2.08439E+01, 3.15474E-03,
    -9.00E+03, 5.50765E+02, 2.01487E+01, 3.06927E-03,
    -8.00E+03, 5.47199E+02, 1.94724E+01, 2.98558E-03,
    -7.00E+03, 5.43633E+02, 1.88146E+01, 2.90365E-03,
    -6.00E+03, 5.40067E+02, 1.81749E+01, 2.82344E-03,
    -5.00E+03, 5.36501E+02, 1.75529E+01, 2.74495E-03,
    -4.00E+03, 5.32935E+02, 1.69483E+01, 2.66813E-03,
    -3.00E+03, 5.29368E+02, 1.63607E+01, 2.59297E-03,
    -2.00E+03, 5.25802E+02, 1.57896E+01, 2.51944E-03,
    -1.00E+03, 5.22236E+02, 1.52348E+01, 2.44752E-03,
    0.00E+00, 5.18670E+02, 1.46959E+01, 2.37717E-03,
    1.00E+03, 5.15104E+02, 1.41726E+01, 2.30839E-03,
    2.00E+03, 5.11538E+02, 1.36644E+01, 2.24114E-03,
    3.00E+03, 5.07972E+02, 1.31711E+01, 2.17539E-03,
    4.00E+03, 5.04405E+02, 1.26923E+01, 2.11114E-03,
    5.00E+03, 5.00839E+02, 1.22277E+01, 2.04834E-03,
    6.00E+03, 4.97273E+02, 1.17770E+01, 1.98698E-03,
    7.00E+03, 4.93707E+02, 1.13398E+01, 1.92704E-03,
    8.00E+03, 4.90141E+02, 1.09159E+01, 1.86850E-03,
    9.00E+03, 4.86575E+02, 1.05049E+01, 1.81132E-03,
    1.00E+04, 4.83008E+02, 1.01065E+01, 1.75549E-03,
    1.10E+04, 4.79442E+02, 9.72040E+00, 1.70099E-03,
    1.20E+04, 4.75876E+02, 9.34636E+00, 1.64779E-03,
    1.30E+04, 4.72310E+02, 8.98405E+00, 1.59588E-03,
    1.40E+04, 4.68744E+02, 8.63321E+00, 1.54522E-03,
    1.50E+04, 4.65178E+02, 8.29354E+00, 1.49581E-03,
    1.60E+04, 4.61611E+02, 7.96478E+00, 1.44761E-03,
    1.70E+04, 4.58045E+02, 7.64665E+00, 1.40061E-03,
    1.80E+04, 4.54479E+02, 7.33889E+00, 1.35479E-03,
    1.90E+04, 4.50913E+02, 7.04123E+00, 1.31012E-03,
    2.00E+04, 4.47347E+02, 6.75343E+00, 1.26659E-03,
    2.10E+04, 4.43781E+02, 6.47523E+00, 1.22417E-03,
    2.20E+04, 4.40214E+02, 6.20638E+00, 1.18285E-03,
    2.30E+04, 4.36648E+02, 5.94664E+00, 1.14260E-03,
    2.40E+04, 4.33082E+02, 5.69578E+00, 1.10341E-03,
    2.50E+04, 4.29516E+02, 5.45355E+00, 1.06526E-03,
    2.60E+04, 4.25950E+02, 5.21974E+00, 1.02812E-03,
    2.70E+04, 4.22384E+02, 4.99410E+00, 9.91984E-04,
    2.80E+04, 4.18818E+02, 4.77644E+00, 9.56827E-04,
    2.90E+04, 4.15251E+02, 4.56651E+00, 9.22631E-04,
    3.00E+04, 4.11685E+02, 4.36413E+00, 8.89378E-04,
    3.10E+04, 4.08119E+02, 4.16906E+00, 8.57050E-04,
    3.20E+04, 4.04553E+02, 3.98112E+00, 8.25628E-04,
    3.30E+04, 4.00987E+02, 3.80010E+00, 7.95096E-04,
    3.40E+04, 3.97421E+02, 3.62580E+00, 7.65434E-04,
    3.50E+04, 3.93854E+02, 3.45803E+00, 7.36627E-04,
    3.60E+04, 3.90288E+02, 3.29661E+00, 7.08657E-04,
    3.70E+04, 3.89970E+02, 3.14191E+00, 6.75954E-04,
    3.80E+04, 3.89970E+02, 2.99447E+00, 6.44234E-04,
    3.90E+04, 3.89970E+02, 2.85395E+00, 6.14002E-04,
    4.00E+04, 3.89970E+02, 2.72003E+00, 5.85189E-04,
    4.10E+04, 3.89970E+02, 2.59239E+00, 5.57728E-04,
    4.20E+04, 3.89970E+02, 2.47073E+00, 5.31556E-04,
    4.30E+04, 3.89970E+02, 2.35479E+00, 5.06612E-04,
    4.40E+04, 3.89970E+02, 2.24429E+00, 4.82838E-04,
    4.50E+04, 3.89970E+02, 2.13897E+00, 4.60180E-04,
    4.60E+04, 3.89970E+02, 2.03860E+00, 4.38586E-04,
    4.70E+04, 3.89970E+02, 1.94293E+00, 4.18004E-04,
    4.80E+04, 3.89970E+02, 1.85176E+00, 3.98389E-04,
    4.90E+04, 3.89970E+02, 1.76486E+00, 3.79694E-04,
    5.00E+04, 3.89970E+02, 1.68204E+00, 3.61876E-04,
    5.10E+04, 3.89970E+02, 1.60311E+00, 3.44894E-04,
    5.20E+04, 3.89970E+02, 1.52788E+00, 3.28709E-04,
    5.30E+04, 3.89970E+02, 1.45618E+00, 3.13284E-04,
    5.40E+04, 3.89970E+02, 1.38785E+00, 2.98583E-04,
    5.50E+04, 3.89970E+02, 1.32272E+00, 2.84571E-04,
    5.60E+04, 3.89970E+02, 1.26065E+00, 2.71217E-04,
    5.70E+04, 3.89970E+02, 1.20149E+00, 2.58490E-04,
    5.80E+04, 3.89970E+02, 1.14511E+00, 2.46360E-04,
    5.90E+04, 3.89970E+02, 1.09137E+00, 2.34799E-04,
    6.00E+04, 3.89970E+02, 1.04016E+00, 2.23781E-04,
    6.10E+04, 3.89970E+02, 9.91347E-01, 2.13279E-04,
    6.20E+04, 3.89970E+02, 9.44827E-01, 2.03271E-04,
    6.30E+04, 3.89970E+02, 9.00489E-01, 1.93732E-04,
    6.40E+04, 3.89970E+02, 8.58232E-01, 1.84641E-04,
    6.50E+04, 3.89970E+02, 8.17958E-01, 1.75976E-04,
    6.60E+04, 3.90180E+02, 7.79578E-01, 1.67629E-04,
    6.70E+04, 3.90729E+02, 7.43039E-01, 1.59548E-04,
    6.80E+04, 3.91278E+02, 7.08261E-01, 1.51867E-04,
    6.90E+04, 3.91826E+02, 6.75156E-01, 1.44566E-04,
    7.00E+04, 3.92375E+02, 6.43641E-01, 1.37625E-04,
    7.10E+04, 3.92923E+02, 6.13638E-01, 1.31026E-04,
    7.20E+04, 3.93472E+02, 5.85073E-01, 1.24753E-04,
    7.30E+04, 3.94021E+02, 5.57875E-01, 1.18788E-04,
    7.40E+04, 3.94569E+02, 5.31976E-01, 1.13116E-04,
    7.50E+04, 3.95118E+02, 5.07313E-01, 1.07722E-04,
    7.60E+04, 3.95667E+02, 4.83825E-01, 1.02592E-04,
    7.70E+04, 3.96215E+02, 4.61455E-01, 9.77131E-05,
    7.80E+04, 3.96764E+02, 4.40148E-01, 9.30725E-05,
    7.90E+04, 3.97313E+02, 4.19853E-01, 8.86582E-05,
    8.00E+04, 3.97861E+02, 4.00519E-01, 8.44590E-05,
    8.10E+04, 3.98410E+02, 3.82101E-01, 8.04641E-05,
    8.20E+04, 3.98958E+02, 3.64553E-01, 7.66632E-05,
    8.30E+04, 3.99507E+02, 3.47833E-01, 7.30467E-05,
    8.40E+04, 4.00056E+02, 3.31902E-01, 6.96054E-05,
    8.50E+04, 4.00604E+02, 3.16720E-01, 6.63307E-05,
    8.60E+04, 4.01153E+02, 3.02253E-01, 6.32142E-05,
    8.70E+04, 4.01702E+02, 2.88464E-01, 6.02481E-05,
    8.80E+04, 4.02250E+02, 2.75323E-01, 5.74249E-05,
    8.90E+04, 4.02799E+02, 2.62796E-01, 5.47376E-05,
    9.00E+04, 4.03348E+02, 2.50856E-01, 5.21794E-05,
    9.10E+04, 4.03896E+02, 2.39473E-01, 4.97441E-05,
    9.20E+04, 4.04445E+02, 2.28621E-01, 4.74254E-05,
    9.30E+04, 4.04994E+02, 2.18275E-01, 4.52178E-05,
    9.40E+04, 4.05542E+02, 2.08410E-01, 4.31158E-05,
    9.50E+04, 4.06091E+02, 1.99003E-01, 4.11140E-05,
    9.60E+04, 4.06639E+02, 1.90032E-01, 3.92078E-05,
    9.70E+04, 4.07188E+02, 1.81478E-01, 3.73923E-05,
    9.80E+04, 4.07737E+02, 1.73319E-01, 3.56632E-05,
    9.90E+04, 4.08285E+02, 1.65537E-01, 3.40162E-05,
    1.00E+05, 4.08834E+02, 1.58114E-01, 3.24473E-05,
    1.01E+05, 4.09383E+02, 1.51034E-01, 3.09527E-05,
    1.02E+05, 4.09931E+02, 1.44279E-01, 2.95288E-05,
    1.03E+05, 4.10480E+02, 1.37835E-01, 2.81722E-05,
    1.04E+05, 4.11029E+02, 1.31687E-01, 2.68797E-05,
    1.05E+05, 4.11590E+02, 1.25820E-01, 2.56472E-05,
    1.06E+05, 4.13126E+02, 1.20229E-01, 2.44164E-05,
    1.07E+05, 4.14663E+02, 1.14906E-01, 2.32489E-05,
    1.08E+05, 4.16199E+02, 1.09837E-01, 2.21413E-05,
    1.09E+05, 4.17735E+02, 1.05009E-01, 2.10902E-05,
    1.10E+05, 4.19271E+02, 1.00410E-01, 2.00926E-05,
    1.11E+05, 4.20807E+02, 9.60277E-02, 1.91455E-05,
    1.12E+05, 4.22344E+02, 9.18518E-02, 1.82464E-05,
    1.13E+05, 4.23880E+02, 8.78717E-02, 1.73924E-05,
    1.14E+05, 4.25416E+02, 8.40775E-02, 1.65814E-05,
    1.15E+05, 4.26952E+02, 8.04600E-02, 1.58108E-05,
    1.16E+05, 4.28488E+02, 7.70102E-02, 1.50787E-05,
    1.17E+05, 4.30024E+02, 7.37200E-02, 1.43829E-05,
    1.18E+05, 4.31561E+02, 7.05813E-02, 1.37215E-05,
    1.19E+05, 4.33097E+02, 6.75866E-02, 1.30927E-05,
    1.20E+05, 4.34633E+02, 6.47290E-02, 1.24948E-05,
    1.21E+05, 4.36169E+02, 6.20017E-02, 1.19262E-05,
    1.22E+05, 4.37705E+02, 5.93982E-02, 1.13853E-05,
    1.23E+05, 4.39242E+02, 5.69126E-02, 1.08708E-05,
    1.24E+05, 4.40778E+02, 5.45392E-02, 1.03811E-05,
    1.25E+05, 4.42314E+02, 5.22725E-02, 9.91510E-06,
    1.26E+05, 4.43850E+02, 5.01074E-02, 9.47152E-06,
    1.27E+05, 4.45386E+02, 4.80390E-02, 9.04922E-06,
    1.28E+05, 4.46923E+02, 4.60626E-02, 8.64710E-06,
    1.29E+05, 4.48459E+02, 4.41739E-02, 8.26415E-06,
    1.30E+05, 4.49995E+02, 4.23688E-02, 7.89937E-06,
    1.31E+05, 4.51531E+02, 4.06431E-02, 7.55186E-06,
    1.32E+05, 4.53067E+02, 3.89933E-02, 7.22074E-06,
    1.33E+05, 4.54604E+02, 3.74157E-02, 6.90519E-06,
    1.34E+05, 4.56140E+02, 3.59069E-02, 6.60442E-06,
    1.35E+05, 4.57676E+02, 3.44637E-02, 6.31770E-06,
    1.36E+05, 4.59212E+02, 3.30831E-02, 6.04432E-06,
    1.37E+05, 4.60748E+02, 3.17621E-02, 5.78363E-06,
    1.38E+05, 4.62284E+02, 3.04980E-02, 5.53499E-06,
    1.39E+05, 4.63821E+02, 2.92882E-02, 5.29782E-06,
    1.40E+05, 4.65357E+02, 2.81301E-02, 5.07154E-06,
    1.41E+05, 4.66893E+02, 2.70214E-02, 4.85563E-06,
    1.42E+05, 4.68429E+02, 2.59599E-02, 4.64957E-06,
    1.43E+05, 4.69965E+02, 2.49433E-02, 4.45289E-06,
    1.44E+05, 4.71502E+02, 2.39696E-02, 4.26513E-06,
    1.45E+05, 4.73038E+02, 2.30369E-02, 4.08586E-06,
    1.46E+05, 4.74574E+02, 2.21434E-02, 3.91467E-06,
    1.47E+05, 4.76110E+02, 2.12873E-02, 3.75117E-06,
    1.48E+05, 4.77646E+02, 2.04668E-02, 3.59499E-06,
    1.49E+05, 4.79183E+02, 1.96805E-02, 3.44579E-06,
    1.50E+05, 4.80719E+02, 1.89267E-02, 3.30323E-06,
    1.51E+05, 4.82255E+02, 1.82041E-02, 3.16699E-06,
    1.52E+05, 4.83791E+02, 1.75112E-02, 3.03678E-06,
    1.53E+05, 4.85327E+02, 1.68468E-02, 2.91230E-06,
    1.54E+05, 4.86864E+02, 1.62096E-02, 2.79331E-06,
    1.55E+05, 4.87170E+02, 1.55977E-02, 2.68618E-06,
    1.56E+05, 4.87170E+02, 1.50090E-02, 2.58480E-06,
    1.57E+05, 4.87170E+02, 1.44425E-02, 2.48724E-06,
    1.58E+05, 4.87170E+02, 1.38974E-02, 2.39336E-06,
    1.59E+05, 4.87170E+02, 1.33729E-02, 2.30303E-06,
    1.60E+05, 4.87170E+02, 1.28682E-02, 2.21610E-06,
    1.61E+05, 4.87170E+02, 1.23825E-02, 2.13246E-06,
    1.62E+05, 4.87170E+02, 1.19151E-02, 2.05198E-06,
    1.63E+05, 4.87170E+02, 1.14654E-02, 1.97453E-06,
    1.64E+05, 4.87170E+02, 1.10327E-02, 1.90000E-06,
    1.65E+05, 4.87170E+02, 1.06163E-02, 1.82829E-06,
    1.66E+05, 4.87170E+02, 1.02156E-02, 1.75929E-06,
    1.67E+05, 4.87170E+02, 9.83000E-03, 1.69289E-06,
    1.68E+05, 4.86130E+02, 9.45872E-03, 1.63243E-06,
    1.69E+05, 4.84594E+02, 9.10042E-03, 1.57557E-06,
    1.70E+05, 4.83057E+02, 8.75461E-03, 1.52052E-06,
    1.80E+05, 4.67695E+02, 5.90183E-03, 1.05871E-06,
    1.90E+05, 4.52334E+02, 3.92660E-03, 7.28304E-07,
    2.00E+05, 4.36972E+02, 2.57592E-03, 4.94576E-07,
    2.10E+05, 4.21610E+02, 1.66454E-03, 3.31236E-07,
    2.20E+05, 4.06248E+02, 1.05832E-03, 2.18565E-07,
    2.30E+05, 3.90886E+02, 6.61237E-04, 1.41926E-07,
    2.40E+05, 3.78623E+02, 4.05997E-04, 8.99644E-08,
    2.50E+05, 3.67650E+02, 2.45671E-04, 5.60626E-08,
    ])

_raw_data = np.reshape(_raw_data, (_raw_data.size // 6, 6))

atm_data.alt = _raw_data[:, 0]

atm_data.T = _raw_data[:, 1]

atm_data.P = _raw_data[:, 2]

atm_data.rho = _raw_data[:, 3]